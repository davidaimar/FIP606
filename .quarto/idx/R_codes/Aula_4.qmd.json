{"title":"Obtendo dados através do copiar e colar","markdown":{"yaml":{"title":"Obtendo dados através do copiar e colar","format":"html"},"headingText":"'dat' e 'dat2' são iguais, o que muda é a forma de vizualização dos dados no chunk.","containsRefs":false,"markdown":"\n\nPara obter dados diretamente de tabelas em sites ou qualquer outro documento digital e criar data.frames no R você pode utilizar dois pacotes, o **tibble** e o **datapasta**. Ambos compilam os dados copiados e organizam mantendo o formato original dentro do chunk, uma maneira simples que otimiza o seu `Ctrl + C` & `Ctrl + V`.\n\nUsando o **datapasta**, após copiar três colunas de dados de uma planilha, basta clicar em `Addins...` e `Past as data.frame`.\n\n```{r}\nlibrary(datapasta)\n\ndat <- data.frame(\n  stringsAsFactors = FALSE, # 'stringsAsFactors' converte variáveis em um data frame para fatores\n              trat = c(\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\n                       \"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"control\",\n                       \"control\",\"control\",\"control\",\"control\",\"control\",\"control\",\n                       \"control\",\"control\",\"control\"),\n               rep = c(1L,2L,3L,4L,5L,6L,7L,8L,\n                       9L,10L,1L,2L,3L,4L,5L,6L,7L,8L,9L,10L),\n              comp = c(9,12.5,10,8,13.2,11,10.8,\n                       9.5,10.8,10.4,13.72,15.91,15.7,14.2,15.9,16.54,\n                       18,14.4,16.41,16)\n)\ndat\n\n```\n\nAgora, com o pacote **tibble**, basta clicar em `Addins...` e `Past as tribble`.\n\n```{r}\nlibrary(tibble)\n\ndat2 <- tribble(\n      ~trat, ~rep, ~comp,\n      \"Mg2\",   1L,     9,\n      \"Mg2\",   2L,  12.5,\n      \"Mg2\",   3L,    10,\n      \"Mg2\",   4L,     8,\n      \"Mg2\",   5L,  13.2,\n      \"Mg2\",   6L,    11,\n      \"Mg2\",   7L,  10.8,\n      \"Mg2\",   8L,   9.5,\n      \"Mg2\",   9L,  10.8,\n      \"Mg2\",  10L,  10.4,\n  \"control\",   1L, 13.72,\n  \"control\",   2L, 15.91,\n  \"control\",   3L,  15.7,\n  \"control\",   4L,  14.2,\n  \"control\",   5L,  15.9,\n  \"control\",   6L, 16.54,\n  \"control\",   7L,    18,\n  \"control\",   8L,  14.4,\n  \"control\",   9L, 16.41,\n  \"control\",  10L,    16\n  )\ndat2\n\n\n```\n\nVeja mais esse exemplo, com o **tribble**, de um conjunto de dados disponível [aqui](https://escritacientifica.sc.usp.br/estatisticas/estatisticas-por-paises/):\n\n```{r}\nvisitas <- tribble(\n        ~`codigo`,            ~país,    ~`n2`,\n               1L,         \"Brazil\",    4303L,\n               2L,     \"Mozambique\",      43L,\n               3L,       \"Portugal\",      33L,\n               4L,  \"United States\",      23L,\n               5L,         \"Angola\",      19L,\n               6L,          \"Spain\",      16L,\n               7L,      \"(not set)\",      12L,\n               8L,       \"Colombia\",       8L,\n               9L,        \"Germany\",       5L,\n              10L,        \"Hungary\",       5L,\n              11L, \"United Kingdom\",       5L,\n              12L,    \"Netherlands\",       4L,\n              13L,        \"Ecuador\",       3L,\n              14L,         \"France\",       3L,\n              15L,          \"Chile\",       2L,\n              16L,       \"Paraguay\",       2L,\n              17L,           \"Peru\",       2L,\n              18L,      \"Argentina\",       1L,\n              19L,        \"Austria\",       1L,\n              20L,        \"Bolivia\",       1L,\n              21L,     \"Cape Verde\",       1L,\n              22L,          \"China\",       1L,\n              23L,          \"Egypt\",       1L,\n              24L,        \"Finland\",       1L,\n              25L,          \"India\",       1L,\n              26L,          \"Italy\",       1L,\n              27L,       \"Malaysia\",       1L,\n              28L,       \"Pakistan\",       1L,\n              29L,         \"Poland\",       1L,\n              30L,      \"Singapore\",       1L,\n              31L,    \"Timor-Leste\",       1L,\n              32L,        \"Uruguay\",       1L\n             )\nvisitas\n\n```\n\n# Outros tipos de gráficos\n\n## Montando gráfico à partir de um data frame criado\n\n```{r warning=FALSE, message=FALSE}\nlibrary(tidyverse)\n\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  ) \n\n```\n\nFazendo o uso da função `pivot_longer()` para modificar a aquitetura dos dados de uma maneira em que cada observação ocupa uma linha separada em uma tabela, e diferentes medidas ou variáveis sejam armazenadas em colunas diferentes, o \"formato longo\", e criando um gráfico de linhas e pontos.\n\n```{r}\npepper |>\n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") |> \n  ggplot(aes(t, inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\",\n           x = 12,\n           y = 0.79,\n           label = \"1\")+\nannotate(geom = \"text\",\n           x = 26,\n           y = 0.80,\n           label = \"2\")+\n  annotate(geom = \"text\",\n           x = 47,\n           y = 0.76,\n           label = \"3\")+\n  theme(legend.position = \"none\")\n\n```\n\n## Tabela de Contigência\n\nVeja como criar uma tabela de contigência à partir de dados disponíveis em um documento online no formato CSV.\n\nO pacote **janitor** será usado para limpeza e organização de dados. A função `tabyl()` cria tabelas de frequência cruzada. Aqui, iremos criar uma tabela de contagem de combinações únicas das variáveis \"cultivar\" e \"farm_management\".\n\n```{r warning=FALSE, message=FALSE}\nlibrary(ggthemes)\n\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\n\nlibrary(janitor)\ncr |> \n  tabyl(cultivar, farm_management)\n\n\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management,\n             label = n))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_canva()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n        legend.position = \"top\")+\n  geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n\n```\n\nOs dados são de uma pesquisa sobre ferrugem do café na Etiópia e contam as ocorrências de diferentes combinações de métodos de gestão agrícola (`farm_management`) e cultivares (`cultivar`), e visualiza essas contagens em um gráfico de barras facetado por cultivar, com barras coloridas por método de gestão agrícola.\n\n## Medidas de tendência central em gráficos\n\nAqui veremos uma maneira de, à partir de dados importados, ralizar cálculos estatísticos (média e desvio padrão) agrupados por uma variável, e então visualiza os resultados em um gráfico.\n\nVamos usar o `geom_errorbar()` para adicionar barras de erro ao gráfico, representando a variação de um desvio padrão acima e abaixo da média, com largura das barras definida como 0.1.\n\n```{r}\nlibrary(gsheet)\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n\nmg |> \n  group_by(trat) |> \n  summarise(mean_comp = mean(comp), sd_comp = sd(comp))|> \n  ggplot(aes(trat, mean_comp))+\n  geom_point(size = 3)+\n  ylim(5,20)+ # Define os limites do eixo y de 5 a 20\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp), width = 0.1)+\n  annotate (geom = \"text\",\n           x = 1, y = 17.5,\n           label = '*')\n\n# 'group_by(trat)': Agrupa os dados pela coluna trat (tratamento).\n# 'summarise(mean_comp = mean(comp), sd_comp = sd(comp))': Calcula a média (mean()) e o desvio padrão (sd()) da coluna comp para cada grupo de trat.\n\n```\n\nCom os mesmos dados, podemos ainda, criae um gráfico de dispersão (`jitter plot`), que mostra a distribuição dos valores de comp para diferentes níveis de tratatamento.\n\n```{r}\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n\n```\n","srcMarkdownNoYaml":"\n\nPara obter dados diretamente de tabelas em sites ou qualquer outro documento digital e criar data.frames no R você pode utilizar dois pacotes, o **tibble** e o **datapasta**. Ambos compilam os dados copiados e organizam mantendo o formato original dentro do chunk, uma maneira simples que otimiza o seu `Ctrl + C` & `Ctrl + V`.\n\nUsando o **datapasta**, após copiar três colunas de dados de uma planilha, basta clicar em `Addins...` e `Past as data.frame`.\n\n```{r}\nlibrary(datapasta)\n\ndat <- data.frame(\n  stringsAsFactors = FALSE, # 'stringsAsFactors' converte variáveis em um data frame para fatores\n              trat = c(\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\n                       \"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"control\",\n                       \"control\",\"control\",\"control\",\"control\",\"control\",\"control\",\n                       \"control\",\"control\",\"control\"),\n               rep = c(1L,2L,3L,4L,5L,6L,7L,8L,\n                       9L,10L,1L,2L,3L,4L,5L,6L,7L,8L,9L,10L),\n              comp = c(9,12.5,10,8,13.2,11,10.8,\n                       9.5,10.8,10.4,13.72,15.91,15.7,14.2,15.9,16.54,\n                       18,14.4,16.41,16)\n)\ndat\n\n```\n\nAgora, com o pacote **tibble**, basta clicar em `Addins...` e `Past as tribble`.\n\n```{r}\nlibrary(tibble)\n\ndat2 <- tribble(\n      ~trat, ~rep, ~comp,\n      \"Mg2\",   1L,     9,\n      \"Mg2\",   2L,  12.5,\n      \"Mg2\",   3L,    10,\n      \"Mg2\",   4L,     8,\n      \"Mg2\",   5L,  13.2,\n      \"Mg2\",   6L,    11,\n      \"Mg2\",   7L,  10.8,\n      \"Mg2\",   8L,   9.5,\n      \"Mg2\",   9L,  10.8,\n      \"Mg2\",  10L,  10.4,\n  \"control\",   1L, 13.72,\n  \"control\",   2L, 15.91,\n  \"control\",   3L,  15.7,\n  \"control\",   4L,  14.2,\n  \"control\",   5L,  15.9,\n  \"control\",   6L, 16.54,\n  \"control\",   7L,    18,\n  \"control\",   8L,  14.4,\n  \"control\",   9L, 16.41,\n  \"control\",  10L,    16\n  )\ndat2\n\n# 'dat' e 'dat2' são iguais, o que muda é a forma de vizualização dos dados no chunk.\n\n```\n\nVeja mais esse exemplo, com o **tribble**, de um conjunto de dados disponível [aqui](https://escritacientifica.sc.usp.br/estatisticas/estatisticas-por-paises/):\n\n```{r}\nvisitas <- tribble(\n        ~`codigo`,            ~país,    ~`n2`,\n               1L,         \"Brazil\",    4303L,\n               2L,     \"Mozambique\",      43L,\n               3L,       \"Portugal\",      33L,\n               4L,  \"United States\",      23L,\n               5L,         \"Angola\",      19L,\n               6L,          \"Spain\",      16L,\n               7L,      \"(not set)\",      12L,\n               8L,       \"Colombia\",       8L,\n               9L,        \"Germany\",       5L,\n              10L,        \"Hungary\",       5L,\n              11L, \"United Kingdom\",       5L,\n              12L,    \"Netherlands\",       4L,\n              13L,        \"Ecuador\",       3L,\n              14L,         \"France\",       3L,\n              15L,          \"Chile\",       2L,\n              16L,       \"Paraguay\",       2L,\n              17L,           \"Peru\",       2L,\n              18L,      \"Argentina\",       1L,\n              19L,        \"Austria\",       1L,\n              20L,        \"Bolivia\",       1L,\n              21L,     \"Cape Verde\",       1L,\n              22L,          \"China\",       1L,\n              23L,          \"Egypt\",       1L,\n              24L,        \"Finland\",       1L,\n              25L,          \"India\",       1L,\n              26L,          \"Italy\",       1L,\n              27L,       \"Malaysia\",       1L,\n              28L,       \"Pakistan\",       1L,\n              29L,         \"Poland\",       1L,\n              30L,      \"Singapore\",       1L,\n              31L,    \"Timor-Leste\",       1L,\n              32L,        \"Uruguay\",       1L\n             )\nvisitas\n\n```\n\n# Outros tipos de gráficos\n\n## Montando gráfico à partir de um data frame criado\n\n```{r warning=FALSE, message=FALSE}\nlibrary(tidyverse)\n\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  ) \n\n```\n\nFazendo o uso da função `pivot_longer()` para modificar a aquitetura dos dados de uma maneira em que cada observação ocupa uma linha separada em uma tabela, e diferentes medidas ou variáveis sejam armazenadas em colunas diferentes, o \"formato longo\", e criando um gráfico de linhas e pontos.\n\n```{r}\npepper |>\n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") |> \n  ggplot(aes(t, inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\",\n           x = 12,\n           y = 0.79,\n           label = \"1\")+\nannotate(geom = \"text\",\n           x = 26,\n           y = 0.80,\n           label = \"2\")+\n  annotate(geom = \"text\",\n           x = 47,\n           y = 0.76,\n           label = \"3\")+\n  theme(legend.position = \"none\")\n\n```\n\n## Tabela de Contigência\n\nVeja como criar uma tabela de contigência à partir de dados disponíveis em um documento online no formato CSV.\n\nO pacote **janitor** será usado para limpeza e organização de dados. A função `tabyl()` cria tabelas de frequência cruzada. Aqui, iremos criar uma tabela de contagem de combinações únicas das variáveis \"cultivar\" e \"farm_management\".\n\n```{r warning=FALSE, message=FALSE}\nlibrary(ggthemes)\n\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\n\nlibrary(janitor)\ncr |> \n  tabyl(cultivar, farm_management)\n\n\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management,\n             label = n))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_canva()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n        legend.position = \"top\")+\n  geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n\n```\n\nOs dados são de uma pesquisa sobre ferrugem do café na Etiópia e contam as ocorrências de diferentes combinações de métodos de gestão agrícola (`farm_management`) e cultivares (`cultivar`), e visualiza essas contagens em um gráfico de barras facetado por cultivar, com barras coloridas por método de gestão agrícola.\n\n## Medidas de tendência central em gráficos\n\nAqui veremos uma maneira de, à partir de dados importados, ralizar cálculos estatísticos (média e desvio padrão) agrupados por uma variável, e então visualiza os resultados em um gráfico.\n\nVamos usar o `geom_errorbar()` para adicionar barras de erro ao gráfico, representando a variação de um desvio padrão acima e abaixo da média, com largura das barras definida como 0.1.\n\n```{r}\nlibrary(gsheet)\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n\nmg |> \n  group_by(trat) |> \n  summarise(mean_comp = mean(comp), sd_comp = sd(comp))|> \n  ggplot(aes(trat, mean_comp))+\n  geom_point(size = 3)+\n  ylim(5,20)+ # Define os limites do eixo y de 5 a 20\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp), width = 0.1)+\n  annotate (geom = \"text\",\n           x = 1, y = 17.5,\n           label = '*')\n\n# 'group_by(trat)': Agrupa os dados pela coluna trat (tratamento).\n# 'summarise(mean_comp = mean(comp), sd_comp = sd(comp))': Calcula a média (mean()) e o desvio padrão (sd()) da coluna comp para cada grupo de trat.\n\n```\n\nCom os mesmos dados, podemos ainda, criae um gráfico de dispersão (`jitter plot`), que mostra a distribuição dos valores de comp para diferentes níveis de tratatamento.\n\n```{r}\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"Aula_4.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":{"light":"default","dark":"cyborg"},"title":"Obtendo dados através do copiar e colar"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}