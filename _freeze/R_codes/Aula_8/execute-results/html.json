{
  "hash": "c1f99746c6636a9e8abbc275c981f63a",
  "result": {
    "markdown": "---\ntitle: \"aula8\"\nformat: html\neditor_options: \n  chunk_output_type: console\n---\n\n\n# 15/05/2024\n\n## Pacotes\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-1_2c4a109f2f38ca0a8313d9792f353a2b'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(ggthemes)\nlibrary(lme4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n:::\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: mvtnorm\nCarregando pacotes exigidos: survival\nCarregando pacotes exigidos: TH.data\nCarregando pacotes exigidos: MASS\n\nAttaching package: 'MASS'\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\n\nAttaching package: 'TH.data'\n\nThe following object is masked from 'package:MASS':\n\n    geyser\n```\n:::\n\n```{.r .cell-code}\nlibrary(r4pde)\nlibrary(broom)\nlibrary(patchwork)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'patchwork'\n\nThe following object is masked from 'package:MASS':\n\n    area\n```\n:::\n:::\n\n\n## Anova fatorial\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-2_391c246baaa7e7309de58a8ef0a3000a'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nfungicida <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672\")\n\n\nfungicida$dose <- as.factor(fungicida$dose)\n\nfungicida |> \n  ggplot(aes(treat,severity, color = dose))+\n  #geom_boxplot()+\n  geom_jitter(width = 0.2, size = 2.5)+\n  #facet_wrap(~dose)+\n  theme_few()+\n  scale_fill_few()+\n  theme(legend.title = element_blank(), legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmf <- lm(severity ~ treat*dose, data = fungicida)\n\nmf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = severity ~ treat * dose, data = fungicida)\n\nCoefficients:\n            (Intercept)        treatTebuconazole                    dose2  \n                 0.2921                  -0.2711                  -0.2420  \ntreatTebuconazole:dose2  \n                 0.2412  \n```\n:::\n\n```{.r .cell-code}\nanova(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(mf))\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmf_medias <- emmeans(mf, ~ treat | dose)\nmf_medias\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789\n\ndose = 2:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(mf_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  1    \n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   2   \n\ndose = 2:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  1    \n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\nmf_medias_linha <- emmeans(mf, ~ dose | treat)\nmf_medias_linha\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL\n 0.5  0.2921 0.0273 16  0.23420   0.3500\n 2    0.0501 0.0273 16 -0.00781   0.1080\n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL\n 0.5  0.0210 0.0273 16 -0.03690   0.0789\n 2    0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(mf_medias_linha,Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n 2    0.0501 0.0273 16 -0.00781   0.1080  a    \n 0.5  0.2921 0.0273 16  0.23420   0.3500   b   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n 2    0.0202 0.0273 16 -0.03768   0.0781  a    \n 0.5  0.0210 0.0273 16 -0.03690   0.0789  a    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n## importa dados\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-3_6d64972c6b5465c252a7689f3b77b960'}\n\n```{.r .cell-code}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n:::\n\n\n## Vizualizar\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-4_cab8f6b23735527fe32fbfea527cace0'}\n\n```{.r .cell-code}\nmilho |> \n  ggplot(aes(method, index))+\n  geom_jitter(width = 0.01, color = \"black\")+\n  facet_wrap(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = 'black', size = 0.5, alpha = 0.5)+\n  theme_few()+\n    labs(x = 'Method',\n       y = 'Index')\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Modelo para análise estatística em parcelas subdivididas\n\n### Variável 1\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-5_bebe07def23d9670c9b72361628d7b23'}\n\n```{.r .cell-code}\nmilho <- milho |> \n  mutate(block = as.factor(block))\n\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho) # Modelos Lineares de Efeitos Mistos\n \nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nhybrid        15.3159  5   0.009095 **\nmethod         3.8886  1   0.048615 * \nblock          0.0783  3   0.994305   \nhybrid:method 13.3812  5   0.020057 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n### Testando a premissas\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-6_98d4d15593263320d091e2950654cd0f'}\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.440).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.970).\n```\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(residuals(mix2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(mix2)\nW = 0.97643, p-value = 0.44\n```\n:::\n:::\n\n\n### Teste de médias\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-7_5ffbee7db2c443e17c14e2f030f15fc4'}\n\n```{.r .cell-code}\nmedias_milho <- emmeans(mix2,\n                        ~ hybrid | method,\n                        type = \"response\")\n\nmedias_milho2 <- emmeans(mix2,\n                        ~ method | hybrid,\n                        type = \"response\")\n```\n:::\n\n\n### Vizualizando\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-8_a489301ef14987c3a1efc904b58b0153'}\n\n```{.r .cell-code}\ncld(medias_milho, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.4 10.3 5155     4.50     44.7  a    \n 30K64        20.3 10.5 5155     4.93     46.1  a    \n 30F53 YH     24.5 11.5 5155     7.11     52.3  ab   \n 30F53 HX     25.0 11.6 5155     7.35     53.0  ab   \n 30S31YH      31.7 13.1 5155    11.20     62.6  ab   \n 30S31H       37.1 14.2 5155    14.52     70.2   b   \n\nmethod = silk:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.1 10.2 5155     4.35     44.3  a    \n 30K64        21.3 10.8 5155     5.44     47.6  a    \n 30F53 HX     24.4 11.5 5155     7.07     52.2  a    \n 30F53 YH     26.0 11.9 5155     7.95     54.6  a    \n 30S31H       26.3 12.0 5155     8.11     55.0  a    \n 30S31YH      26.4 12.0 5155     8.16     55.1  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-9_1b661075aa95fe04581ddbfdfabad07f'}\n\n```{.r .cell-code}\ncld(medias_milho2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method response   SE   df lower.CL upper.CL .group\n silk       24.4 11.5 5155     7.07     52.2  a    \n pin        25.0 11.6 5155     7.35     53.0  a    \n\nhybrid = 30F53 YH:\n method response   SE   df lower.CL upper.CL .group\n pin        24.5 11.5 5155     7.11     52.3  a    \n silk       26.0 11.9 5155     7.95     54.6  a    \n\nhybrid = 30K64:\n method response   SE   df lower.CL upper.CL .group\n pin        20.3 10.5 5155     4.93     46.1  a    \n silk       21.3 10.8 5155     5.44     47.6  a    \n\nhybrid = 30S31H:\n method response   SE   df lower.CL upper.CL .group\n silk       26.3 12.0 5155     8.11     55.0  a    \n pin        37.1 14.2 5155    14.52     70.2   b   \n\nhybrid = 30S31YH:\n method response   SE   df lower.CL upper.CL .group\n silk       26.4 12.0 5155     8.16     55.1  a    \n pin        31.7 13.1 5155    11.20     62.6  a    \n\nhybrid = BG7049H:\n method response   SE   df lower.CL upper.CL .group\n silk       19.1 10.2 5155     4.35     44.3  a    \n pin        19.4 10.3 5155     4.50     44.7  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n## Variável 2\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-10_e30263356f7828bc45c7bba8bdb86029'}\n\n```{.r .cell-code}\nmix3<- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid), data = milho)\n\nAnova(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(yield)\n                Chisq Df Pr(>Chisq)    \nhybrid        25.5591  5  0.0001086 ***\nmethod         0.0520  1  0.8196750    \nblock          2.3606  3  0.5010021    \nhybrid:method 24.4985  5  0.0001741 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Testando a premissas\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-11_85ad7a431fb600404dd1960de56e1dbd'}\n\n```{.r .cell-code}\ncheck_normality(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.214).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.686).\n```\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(mix3))\nqqline(residuals(mix3))\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals(mix3))\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\n\n## Teste de médias\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-12_3fc85668e2c57947c1e9f4a9223d7a1e'}\n\n```{.r .cell-code}\nmedias_milho_prod <- emmeans(mix3,\n                        ~ hybrid | method,\n                        type = \"response\")\n\nmedias_milho_prod2 <- emmeans(mix3,\n                        ~ method | hybrid,\n                        type = \"response\")\n```\n:::\n\n\n### Vizualizando\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-13_f7e4d7d760ab422478e34b1247c066ce'}\n\n```{.r .cell-code}\ncld(medias_milho_prod, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   response  SE   df lower.CL upper.CL .group\n 30S31YH      7829 732 26.1     6398     9405  a    \n 30S31H       8081 743 26.1     6626     9681  ab   \n 30F53 YH     9314 798 26.1     7746    11027  abc  \n 30F53 HX    11130 872 26.1     9410    12995   bc  \n 30K64       11666 893 26.1     9903    13574    c  \n BG7049H     11914 903 26.1    10131    13841    c  \n\nmethod = silk:\n hybrid   response  SE   df lower.CL upper.CL .group\n 30S31YH      8257 751 26.1     6785     9873  a    \n 30F53 YH     9079 788 26.1     7532    10770  a    \n 30S31H       9135 790 26.1     7583    10832  a    \n 30F53 HX     9932 824 26.1     8311    11698  ab   \n 30K64       10331 840 26.1     8676    12131  ab   \n BG7049H     12822 936 26.1    10970    14818   b   \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-14_79bee6def96e5f6feabf14b2ba5622ec'}\n\n```{.r .cell-code}\ncld(medias_milho_prod2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method response  SE   df lower.CL upper.CL .group\n silk       9932 824 26.1     8311    11698  a    \n pin       11130 872 26.1     9410    12995   b   \n\nhybrid = 30F53 YH:\n method response  SE   df lower.CL upper.CL .group\n silk       9079 788 26.1     7532    10770  a    \n pin        9314 798 26.1     7746    11027  a    \n\nhybrid = 30K64:\n method response  SE   df lower.CL upper.CL .group\n silk      10331 840 26.1     8676    12131  a    \n pin       11666 893 26.1     9903    13574   b   \n\nhybrid = 30S31H:\n method response  SE   df lower.CL upper.CL .group\n pin        8081 743 26.1     6626     9681  a    \n silk       9135 790 26.1     7583    10832   b   \n\nhybrid = 30S31YH:\n method response  SE   df lower.CL upper.CL .group\n pin        7829 732 26.1     6398     9405  a    \n silk       8257 751 26.1     6785     9873  a    \n\nhybrid = BG7049H:\n method response  SE   df lower.CL upper.CL .group\n pin       11914 903 26.1    10131    13841  a    \n silk      12822 936 26.1    10970    14818  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}