{
  "hash": "a5512cee114fe9eb69ec42848d024441",
  "result": {
    "markdown": "---\ntitle: \"ANOVA Fatorial\"\nformat: html\n---\n\n\nExperimentos fatoriais são aqueles em que se estudam simultaneamente dois ou mais fatores, cada um deles com dois ou mais níveis.\n\nO fatorial é um tipo de esquema, ou seja, uma das maneiras de organizar os tratamentos e não um tipo de delineamento, que representa a maneira pela qual os tratamentos são distribuídos às unidades experimentais.\n\nAqui você aprenderá a realizar uma ANOVA fatorial no R.\n\nPacotes necessários\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-1_1f9663e8887c80d571b7aa4c348e9df9'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\nlibrary(ggthemes)\nlibrary(DHARMa)\nlibrary(emmeans)\nlibrary(multcomp)\n```\n:::\n\n\nRealizando a Importação, Vizualização Gráfica, Anova Fatorial, Checagem de Pressuposições e Tukey\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-2_392a4248c212aba1e560921f703c6e65'}\n\n```{.r .cell-code}\nfungicida <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672\")\n\nfungicida$dose <- as.factor(fungicida$dose)\n\nfungicida |> \n  ggplot(aes(treat,severity, color = dose))+\n  geom_jitter(width = 0.2, size = 2.5)+\n  theme_few()+\n  scale_fill_few()+\n  theme(legend.title = element_blank(), legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-3_5ed08ea4de770627894132225bd4afce'}\n\n```{.r .cell-code}\nmf <- lm(severity ~ treat*dose, data = fungicida)\n\nanova(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-4_1c755a991ce62a1d1704f76a28ce917c'}\n\n```{.r .cell-code}\nplot(simulateResiduals(mf))\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nO agrupamento de médias em experimentos fatoriais deve ser feito para cada fator em relação ao outro\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-5_4d6c7eb5d0517e070e9b2524d9f5f927'}\n\n```{.r .cell-code}\nmf_medias <- emmeans(mf, ~ treat | dose)\n\ncld(mf_medias, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  a    \n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   b   \n\ndose = 2:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  a    \n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  a    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-6_859d4dd02c3fa6c8191497c24d02081b'}\n\n```{.r .cell-code}\nmf_medias_linha <- emmeans(mf, ~ dose | treat)\n\ncld(mf_medias_linha,Letters = letters) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n 2    0.0501 0.0273 16 -0.00781   0.1080  a    \n 0.5  0.2921 0.0273 16  0.23420   0.3500   b   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n 2    0.0202 0.0273 16 -0.03768   0.0781  a    \n 0.5  0.0210 0.0273 16 -0.03690   0.0789  a    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n## ANOVA em Experimentos com Parcelas Subdivididas\n\nTal como no caso de fatorial, o termo parcelas subdivididas se refere a um esquema do experimento, ou seja, a maneira pela qual os tratamentos são organizados. Havendo dois fatores, eles são designados como fator primário e secundário.\n\nNeste caso, as parcelas que recebem os níveis do fator primário são divididas em subparcelas que receberão os níveis do fator secundário.\n\nA ANOVA para esta condição será explorada a seguir\n\nImportando o conjunto de dados\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-7_2f19c6aab14e56acc3675f428d159469'}\n\n```{.r .cell-code}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n:::\n\n\nVizualização gráfica\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-8_cd51040db65fdb0b144f3ccfc4d02cf0'}\n\n```{.r .cell-code}\nmilho |> \n  ggplot(aes(method, index))+\n  geom_jitter(width = 0.01, color = \"black\")+\n  facet_wrap(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = 'black', size = 0.5, alpha = 0.5)+\n  theme_few()+\n    labs(x = 'Method',\n       y = 'Index')\n```\n\n::: {.cell-output-display}\n![](Aula_8_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Modelo para Anova em parcelas subdivididas\n\nUtilizamos os Modelos de Efeitos Mistos através da função `lmer()` do pacote **lme4** e sumarizamos o resultado através da função `Anova()` do pacore **car**.\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-9_65a41ac1c354578a9b52b38bbe86f3f2'}\n\n```{.r .cell-code}\nlibrary(lme4)\nlibrary(car)\n\nmilho <- milho |> \n  mutate(block = as.factor(block))\n\nmix <- lmer(index ~ hybrid*method + block + (1|block/hybrid), data = milho) # Modelos Lineares de Efeitos Mistos\n\nAnova(mix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nhybrid        15.5971  5   0.008094 **\nmethod         4.6963  1   0.030228 * \nblock          0.2157  3   0.975023   \nhybrid:method 15.8060  5   0.007420 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nTestando as premissas\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-10_867a6f723acf6f044ca4a6cbf054753c'}\n\n```{.r .cell-code}\nlibrary(performance)\n\ncheck_normality(mix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.635).\n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-11_4cd72c223a1d273ba93ddce9b263f407'}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n:::\n:::\n\n\n### Transformando os dados\n\nHomoscedasticidade não atendida, portanto procederemos com a transformação dos dados via raiz quadrada\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-12_5700bde3d390dc0e830e912eabd63c64'}\n\n```{.r .cell-code}\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data = milho)\n\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nhybrid        15.3159  5   0.009095 **\nmethod         3.8886  1   0.048615 * \nblock          0.0783  3   0.994305   \nhybrid:method 13.3812  5   0.020057 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-13_fa993bdc1f5e2504e9248298e14d3d03'}\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.440).\n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-14_e331cdb5ef57648a202fcfc6a36f9a41'}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.970).\n```\n:::\n:::\n\n\nPresseguindo com o teste de médias\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-15_4f6fa0f8ad8fbd5cd4e64637ab3adb91'}\n\n```{.r .cell-code}\nmedias_milho <- emmeans(mix2,\n                        ~ hybrid | method,\n                        type = \"response\")\n\nmedias_milho2 <- emmeans(mix2,\n                        ~ method | hybrid,\n                        type = \"response\")\n```\n:::\n\n\nVizualizando o resultado\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-16_29c217ab5c9b9f32d0fd75837687bd7d'}\n\n```{.r .cell-code}\ncld(medias_milho, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.4 10.3 5155     4.50     44.7  a    \n 30K64        20.3 10.5 5155     4.93     46.1  a    \n 30F53 YH     24.5 11.5 5155     7.11     52.3  ab   \n 30F53 HX     25.0 11.6 5155     7.35     53.0  ab   \n 30S31YH      31.7 13.1 5155    11.20     62.6  ab   \n 30S31H       37.1 14.2 5155    14.52     70.2   b   \n\nmethod = silk:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.1 10.2 5155     4.35     44.3  a    \n 30K64        21.3 10.8 5155     5.44     47.6  a    \n 30F53 HX     24.4 11.5 5155     7.07     52.2  a    \n 30F53 YH     26.0 11.9 5155     7.95     54.6  a    \n 30S31H       26.3 12.0 5155     8.11     55.0  a    \n 30S31YH      26.4 12.0 5155     8.16     55.1  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-17_ccd07658daab581cd7bd3b5f2ef0f91c'}\n\n```{.r .cell-code}\ncld(medias_milho2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method response   SE   df lower.CL upper.CL .group\n silk       24.4 11.5 5155     7.07     52.2  a    \n pin        25.0 11.6 5155     7.35     53.0  a    \n\nhybrid = 30F53 YH:\n method response   SE   df lower.CL upper.CL .group\n pin        24.5 11.5 5155     7.11     52.3  a    \n silk       26.0 11.9 5155     7.95     54.6  a    \n\nhybrid = 30K64:\n method response   SE   df lower.CL upper.CL .group\n pin        20.3 10.5 5155     4.93     46.1  a    \n silk       21.3 10.8 5155     5.44     47.6  a    \n\nhybrid = 30S31H:\n method response   SE   df lower.CL upper.CL .group\n silk       26.3 12.0 5155     8.11     55.0  a    \n pin        37.1 14.2 5155    14.52     70.2   b   \n\nhybrid = 30S31YH:\n method response   SE   df lower.CL upper.CL .group\n silk       26.4 12.0 5155     8.16     55.1  a    \n pin        31.7 13.1 5155    11.20     62.6  a    \n\nhybrid = BG7049H:\n method response   SE   df lower.CL upper.CL .group\n silk       19.1 10.2 5155     4.35     44.3  a    \n pin        19.4 10.3 5155     4.50     44.7  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n### Segunda variável\n\nRepetindo a análise para uma outra variável, já incluindo a tranformação por raiz quadrada\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-18_cb90c876a81580b471d94b517a215709'}\n\n```{.r .cell-code}\nmix3<- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid), data = milho)\n\nAnova(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(yield)\n                Chisq Df Pr(>Chisq)    \nhybrid        25.5591  5  0.0001086 ***\nmethod         0.0520  1  0.8196750    \nblock          2.3606  3  0.5010021    \nhybrid:method 24.4985  5  0.0001741 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nChecando as pressuposições\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-19_64078fb54efe3f8f7f8bc26613b690a5'}\n\n```{.r .cell-code}\ncheck_normality(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.214).\n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-20_f9c97411623f2ed4d1cd6e81d26f54f9'}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.686).\n```\n:::\n:::\n\n\nTeste de médias\n\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-21_490e4dc4c3142ace73c8cc9dedce4862'}\n\n```{.r .cell-code}\nmedias_milho_prod <- emmeans(mix3,\n                        ~ hybrid | method,\n                        type = \"response\")\n\nmedias_milho_prod2 <- emmeans(mix3,\n                        ~ method | hybrid,\n                        type = \"response\")\n```\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-22_699142e9daf335c50aa1e5442093227f'}\n\n```{.r .cell-code}\ncld(medias_milho_prod, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   response  SE   df lower.CL upper.CL .group\n 30S31YH      7829 732 26.1     6398     9405  a    \n 30S31H       8081 743 26.1     6626     9681  ab   \n 30F53 YH     9314 798 26.1     7746    11027  abc  \n 30F53 HX    11130 872 26.1     9410    12995   bc  \n 30K64       11666 893 26.1     9903    13574    c  \n BG7049H     11914 903 26.1    10131    13841    c  \n\nmethod = silk:\n hybrid   response  SE   df lower.CL upper.CL .group\n 30S31YH      8257 751 26.1     6785     9873  a    \n 30F53 YH     9079 788 26.1     7532    10770  a    \n 30S31H       9135 790 26.1     7583    10832  a    \n 30F53 HX     9932 824 26.1     8311    11698  ab   \n 30K64       10331 840 26.1     8676    12131  ab   \n BG7049H     12822 936 26.1    10970    14818   b   \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='Aula_8_cache/html/unnamed-chunk-23_6cfa2d7725389f04602a182d4143666b'}\n\n```{.r .cell-code}\ncld(medias_milho_prod2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method response  SE   df lower.CL upper.CL .group\n silk       9932 824 26.1     8311    11698  a    \n pin       11130 872 26.1     9410    12995   b   \n\nhybrid = 30F53 YH:\n method response  SE   df lower.CL upper.CL .group\n silk       9079 788 26.1     7532    10770  a    \n pin        9314 798 26.1     7746    11027  a    \n\nhybrid = 30K64:\n method response  SE   df lower.CL upper.CL .group\n silk      10331 840 26.1     8676    12131  a    \n pin       11666 893 26.1     9903    13574   b   \n\nhybrid = 30S31H:\n method response  SE   df lower.CL upper.CL .group\n pin        8081 743 26.1     6626     9681  a    \n silk       9135 790 26.1     7583    10832   b   \n\nhybrid = 30S31YH:\n method response  SE   df lower.CL upper.CL .group\n pin        7829 732 26.1     6398     9405  a    \n silk       8257 751 26.1     6785     9873  a    \n\nhybrid = BG7049H:\n method response  SE   df lower.CL upper.CL .group\n pin       11914 903 26.1    10131    13841  a    \n silk      12822 936 26.1    10970    14818  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}