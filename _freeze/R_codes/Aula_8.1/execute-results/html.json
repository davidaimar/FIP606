{
  "hash": "785d493955f31e492cdd0b36f5dee2ae",
  "result": {
    "markdown": "---\ntitle: \" \"\nformat: html\n---\n\n\n# Regressão linear\n\nEm experimentos onde o fator avaliado é classificado como quantitativo seu efeito deve ser estudado por meio de uma relação funcional entre o mesmo e a variável resposta. A técnica indicada neste caso é a análise de regressão.\n\nTrabalharemos com um conjunto de dados onde o fator testado é quatitativo.\n\nPacotes necessários\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-1_f69c9123477fae0e4f7043665017193b'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(lme4)\nlibrary(r4pde)\nlibrary(broom)\nlibrary(car)\nlibrary(patchwork)\n```\n:::\n\n\nImportação e Vizualização Gráfica dos Dados\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-2_3ad73bb064eb2c20b2a2981ad2360629'}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\n estande |> \n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.1, alpha = 0.2)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = 'black', size = 0.5)+\n  theme_few()+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n### Modelo Linear Simples ou de Primeira Ordem\n\nCriando um filtro para avaliar os dados correspodentes ao primeiro experimento\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-3_36d47701804970db5fcbf36beb19683b'}\n\n```{.r .cell-code}\nexp1 = estande |> \n  filter(exp == 1)\n\n# Vizualização gráfica:\nexp1 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  theme_few()+\n  ylim(0,100)+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\nAjustando o Modelo Linear através do `lm()`:\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-4_c8c4d750f333abe03de097467a1826b9'}\n\n```{.r .cell-code}\nlm1 <- lm(nplants ~ trat,\n          data = exp1)\n\nsummary(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,\tAdjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n```\n:::\n:::\n\nRepetindo para o segundo e terceiro experimento\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-5_7ba032256ee5d1fbdf397d5419406310'}\n\n```{.r .cell-code}\nexp2 = estande |> \n  filter(exp == 2)\n\nexp2 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  theme_few()+\n  ylim(0,100)+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-6_e7ec64136d00c4ac94c932e60ecbb1de'}\n\n```{.r .cell-code}\nlm2 <- lm(nplants ~ trat,\n          data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-7_ab2415338fd74216f127330175286914'}\n\n```{.r .cell-code}\nexp3 = estande |> \n  filter(exp == 3)\n\nexp3 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  theme_few()+\n  ylim(0,100)+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 3 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 3 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-8_53c7bd294eefce12d586e1c8a066321a'}\n\n```{.r .cell-code}\nlm3 <- lm(nplants ~ trat, data = exp3)\n\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-26.5887  -3.9597   0.7177   5.5806  19.8952 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.53 on 22 degrees of freedom\nMultiple R-squared:  0.6085,\tAdjusted R-squared:  0.5907 \nF-statistic: 34.19 on 1 and 22 DF,  p-value: 6.968e-06\n```\n:::\n:::\n\n\nVale lembrar que para ajustar modelos lineares simples os dados devem atender as pressuposições da ANOVA já ensinadas\n\n## Modelo Linear Generalizado (GLM)\n\nUtilizaremos o Critério de Informação de Akaike (AIC) para verificar a qualidade dos modelos testados\n\nFazendo para os dados do terceito experimento e assumindo uma distribuição gaussiana, temos:\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-9_6900405141734d4ad779f29c2e2ddc12'}\n\n```{.r .cell-code}\nglm3 <- glm(nplants ~ trat,\n            data = exp3)\n\nsummary(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, data = exp3)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 110.9787)\n\n    Null deviance: 6235.8  on 23  degrees of freedom\nResidual deviance: 2441.5  on 22  degrees of freedom\nAIC: 185.04\n\nNumber of Fisher Scoring iterations: 2\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-10_c92abb31cdfc00633153e87be9ff80a5'}\n\n```{.r .cell-code}\nAIC(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 185.0449\n```\n:::\n:::\n\n\nAssumindo uma distribuição de poisson, temos:\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-11_591f14e107a047dfbb15330a8db8a3b4'}\n\n```{.r .cell-code}\nglm3b <- glm(nplants ~ trat,\n             family = \"poisson\" (link = \"log\"),\n             data = exp3)\n\nsummary(glm3b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = poisson(link = \"log\"), \n    data = exp3)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.571590   0.029539 154.762  < 2e-16 ***\ntrat        -0.009965   0.001488  -6.697 2.13e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 77.906  on 23  degrees of freedom\nResidual deviance: 29.952  on 22  degrees of freedom\nAIC: 183.93\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-12_5f96087b888eff442010fab870126ae2'}\n\n```{.r .cell-code}\nAIC(glm3b) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 183.9324\n```\n:::\n:::\n\n\nQuanto menor o valor de AIC, melhor é o modelo\n\n## Modelos Lineares Generalizados de Efeitos Mistos (GLMMs)\n\nGLMMs são uma extensão dos GLMs que incorporam efeitos mistos, combinando efeitos fixos e aleatórios. Eles são especialmente úteis em situações onde há correlação ou variabilidade nos dados que podem ser atribuídas a diferentes níveis hierárquicos ou grupos.\n\nVocê pode utilizar os GLMMs através da função `glmer`.\n\n\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-13_85a2e6a5bacba883c643de759b84e821'}\n\n```{.r .cell-code}\nglmer3 <- glmer(nplants ~ trat + (trat | exp), data = estande)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in glmer(nplants ~ trat + (trat | exp), data = estande): calling\nglmer() with family=gaussian (identity link) as a shortcut to lmer() is\ndeprecated; please call lmer() directly\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkConv(attr(opt, \"derivs\"), opt$par, ctrl = control$checkConv, :\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nsummary(glmer3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\nREML criterion at convergence: 580.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.0988 -0.6091  0.1722  0.6360  1.9963 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n exp      (Intercept) 510.68405 22.5983       \n          trat          0.05516  0.2349  -0.82\n Residual             167.91303 12.9581       \nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  69.7452    13.2146   5.278\ntrat         -0.5687     0.1643  -3.462\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.731\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-14_5ed74e7d2b46bca3814bd46083bb3b9f'}\n\n```{.r .cell-code}\nAIC(glmer3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 592.8402\n```\n:::\n:::\n\n\nGLMMs assumindo uma distribuição de poisson\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-15_7274a0948d1f4ed67cfff239656daf6b'}\n\n```{.r .cell-code}\nglmer3b <- glmer(nplants ~ trat + (trat|exp), family = poisson(link = \"log\"),\n                                                              data = estande) \nsummary(glmer3b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: poisson  ( log )\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\n     AIC      BIC   logLik deviance df.resid \n   660.7    672.1   -325.4    650.7       67 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.6247 -0.8083  0.1042  0.9601  3.6511 \n\nRandom effects:\n Groups Name        Variance  Std.Dev. Corr \n exp    (Intercept) 6.425e-02 0.253478      \n        trat        1.602e-05 0.004003 -0.17\nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.223397   0.147793  28.577  < 2e-16 ***\ntrat        -0.010434   0.002538  -4.111 3.93e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.192\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-16_1325f84135d060fbfc2fc1a03d6ad024'}\n\n```{.r .cell-code}\nAIC(glmer3b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 660.7282\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-17_a7b40b0ff2ca0e22c418cb574dd65d17'}\n\n```{.r .cell-code}\nwm <- WhiteMoldSoybean\n\nwm |> \n  ggplot(aes(inc, yld, group = factor(study)))+\n  geom_point()+\n  #facet_wrap(~ study)+\n  geom_smooth(method = \"lm\", se= F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 136\n $ line                            :List of 6\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : num 0.5\n  ..$ linetype     : num 1\n  ..$ lineend      : chr \"butt\"\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ rect                            :List of 5\n  ..$ fill         : chr \"white\"\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : num 0.5\n  ..$ linetype     : num 1\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ text                            :List of 11\n  ..$ family       : chr \"\"\n  ..$ face         : chr \"plain\"\n  ..$ colour       : chr \"black\"\n  ..$ size         : num 11\n  ..$ hjust        : num 0.5\n  ..$ vjust        : num 0.5\n  ..$ angle        : num 0\n  ..$ lineheight   : num 0.9\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ title                           : NULL\n $ aspect.ratio                    : NULL\n $ axis.title                      : NULL\n $ axis.title.x                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.top                :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.bottom             : NULL\n $ axis.title.y                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.y.left               : NULL\n $ axis.title.y.right              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : num -90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text                       :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : chr \"grey30\"\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.top                 :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.bottom              : NULL\n $ axis.text.y                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 1\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.y.left                : NULL\n $ axis.text.y.right               :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.theta                 : NULL\n $ axis.text.r                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0.5\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 2.2points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.ticks                      : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ axis.ticks.x                    : NULL\n $ axis.ticks.x.top                : NULL\n $ axis.ticks.x.bottom             : NULL\n $ axis.ticks.y                    : NULL\n $ axis.ticks.y.left               : NULL\n $ axis.ticks.y.right              : NULL\n $ axis.ticks.theta                : NULL\n $ axis.ticks.r                    : NULL\n $ axis.minor.ticks.x.top          : NULL\n $ axis.minor.ticks.x.bottom       : NULL\n $ axis.minor.ticks.y.left         : NULL\n $ axis.minor.ticks.y.right        : NULL\n $ axis.minor.ticks.theta          : NULL\n $ axis.minor.ticks.r              : NULL\n $ axis.ticks.length               : 'simpleUnit' num 2.75points\n  ..- attr(*, \"unit\")= int 8\n $ axis.ticks.length.x             : NULL\n $ axis.ticks.length.x.top         : NULL\n $ axis.ticks.length.x.bottom      : NULL\n $ axis.ticks.length.y             : NULL\n $ axis.ticks.length.y.left        : NULL\n $ axis.ticks.length.y.right       : NULL\n $ axis.ticks.length.theta         : NULL\n $ axis.ticks.length.r             : NULL\n $ axis.minor.ticks.length         : 'rel' num 0.75\n $ axis.minor.ticks.length.x       : NULL\n $ axis.minor.ticks.length.x.top   : NULL\n $ axis.minor.ticks.length.x.bottom: NULL\n $ axis.minor.ticks.length.y       : NULL\n $ axis.minor.ticks.length.y.left  : NULL\n $ axis.minor.ticks.length.y.right : NULL\n $ axis.minor.ticks.length.theta   : NULL\n $ axis.minor.ticks.length.r       : NULL\n $ axis.line                       : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ axis.line.x                     : NULL\n $ axis.line.x.top                 : NULL\n $ axis.line.x.bottom              : NULL\n $ axis.line.y                     : NULL\n $ axis.line.y.left                : NULL\n $ axis.line.y.right               : NULL\n $ axis.line.theta                 : NULL\n $ axis.line.r                     : NULL\n $ legend.background               : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.margin                   : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing                  : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing.x                : NULL\n $ legend.spacing.y                : NULL\n $ legend.key                      : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.key.size                 : 'simpleUnit' num 1.2lines\n  ..- attr(*, \"unit\")= int 3\n $ legend.key.height               : NULL\n $ legend.key.width                : NULL\n $ legend.key.spacing              : 'simpleUnit' num 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ legend.key.spacing.x            : NULL\n $ legend.key.spacing.y            : NULL\n $ legend.frame                    : NULL\n $ legend.ticks                    : NULL\n $ legend.ticks.length             : 'rel' num 0.2\n $ legend.axis.line                : NULL\n $ legend.text                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.text.position            : NULL\n $ legend.title                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.title.position           : NULL\n $ legend.position                 : chr \"right\"\n $ legend.position.inside          : NULL\n $ legend.direction                : NULL\n $ legend.byrow                    : NULL\n $ legend.justification            : chr \"center\"\n $ legend.justification.top        : NULL\n $ legend.justification.bottom     : NULL\n $ legend.justification.left       : NULL\n $ legend.justification.right      : NULL\n $ legend.justification.inside     : NULL\n $ legend.location                 : NULL\n $ legend.box                      : NULL\n $ legend.box.just                 : NULL\n $ legend.box.margin               : 'margin' num [1:4] 0cm 0cm 0cm 0cm\n  ..- attr(*, \"unit\")= int 1\n $ legend.box.background           : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.box.spacing              : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n  [list output truncated]\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi TRUE\n - attr(*, \"validate\")= logi TRUE\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-18_4be4ecf8849c001509e85450e1044d2d'}\n\n```{.r .cell-code}\nmofo1 <- lm(yld ~ inc,\n            data = wm)\n\nsummary(mofo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3299.619     56.451  58.451  < 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,\tAdjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-19_d8794ec568e38b1d1ec661b54ab98ba9'}\n\n```{.r .cell-code}\nfit_all <- wm |> \n  group_by(study) |> \n  do(tidy(lm(.$yld ~ .$inc), conf.int = TRUE))\n\nfit_all\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 70 × 8\n# Groups:   study [35]\n   study term        estimate std.error statistic  p.value conf.low conf.high\n   <dbl> <chr>          <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n 1     1 (Intercept)  3329.       86.8      38.3  4.60e-13   3138.    3520.  \n 2     1 .$inc         -14.2       2.08     -6.85 2.78e- 5    -18.8     -9.64\n 3     2 (Intercept)  2682.       48.6      55.2  8.55e-15   2575.    2789.  \n 4     2 .$inc          -6.93      1.49     -4.66 6.89e- 4    -10.2     -3.66\n 5     3 (Intercept)  4017.       61.6      65.2  1.37e-15   3882.    4153.  \n 6     3 .$inc         -18.6       1.71    -10.9  3.11e- 7    -22.4    -14.9 \n 7     4 (Intercept)  2814.      151.       18.6  1.15e- 9   2481.    3147.  \n 8     4 .$inc         -43.5      16.8      -2.58 2.56e- 2    -80.5     -6.38\n 9     5 (Intercept)  3317.      234.       14.2  2.07e- 8   2802.    3832.  \n10     5 .$inc         -21.2       5.69     -3.72 3.36e- 3    -33.7     -8.67\n# ℹ 60 more rows\n```\n:::\n\n```{.r .cell-code}\ng_inter <- fit_all |> \n  filter(term == \"(Intercept)\") |> \n  ggplot(aes(x = estimate))+\n  theme_r4pde()+\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  labs(x = \"Intercept\", y = \"frequency\")\n\ng_slop <- fit_all |> \n  filter(term == \".$inc\") |> \n  ggplot(aes(x = estimate))+\n  theme_r4pde()+\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  labs(x = \"Slopes\", y = \"Frequency\")\n\n\ng_inter + g_slop\n```\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndf <- fit_all |>\n  filter(term == \".$inc\")\n\nmean(df$estimate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -19.52932\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-20_4f14824daadce57aae4bba3d1bf29f8d'}\n\n```{.r .cell-code}\nmofo2 <- lmer(yld ~ inc + (inc | study), data = wm,\n              REML = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkConv(attr(opt, \"derivs\"), opt$par, ctrl = control$checkConv, :\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nsummary(mofo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by maximum likelihood  ['lmerMod']\nFormula: yld ~ inc + (inc | study)\n   Data: wm\n\n     AIC      BIC   logLik deviance df.resid \n  5319.4   5343.1  -2653.7   5307.4      376 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7078 -0.5991 -0.0295  0.5077  3.2364 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n study    (Intercept) 557573.08 746.708       \n          inc             36.85   6.071  -0.29\n Residual              37228.73 192.947       \nNumber of obs: 382, groups:  study, 35\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 3455.432    128.063   26.98\ninc          -17.236      1.451  -11.88\n\nCorrelation of Fixed Effects:\n    (Intr)\ninc -0.300\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nAnova(mofo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yld\n     Chisq Df Pr(>Chisq)    \ninc 141.09  1  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nconfint(mofo2, method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 2.5 %     97.5 %\n.sig01              NA         NA\n.sig02              NA         NA\n.sig03              NA         NA\n.sigma              NA         NA\n(Intercept) 3204.43403 3706.43096\ninc          -20.08046  -14.39219\n```\n:::\n:::\n\n\n## Modelo Linear Quadrático ou de Segunda Ordem\n\nUm Modelo Linear de Segunda Ordem (também conhecido como modelo quadrático) é uma extensão do modelo linear de primeira ordem que inclui termos quadráticos para capturar relações curvilíneas entre a variável dependente e as variáveis independentes.\n\nEsse tipo de modelo é útil quando a relação entre as variáveis não é bem representada por uma linha reta, mas sim por uma curva parabólica.\n\nA seguir faremos um comparação da utilização um modelo linear de primeira e segunda ordem para o próximo conjunto de dados\n\nImportação e Vizualização dos Dados\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-21_8fe59cda063d7fcc734755d599607ae7'}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nexp2 <- estande |> filter(exp == 2)\n\nexp2 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  theme_few()+\n  ylim(0, 100)+\n  geom_smooth(method = \"lm\",\n              se = F,\n              formula = y~poly(x,2),\n              color = \"red\")+\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\nO gráfico acima contém uma comparação (modelo simples em azul e o modelo quadrático em vermelho) entre ambos os modelos. Concluiremos com base nas análises estatístics à seguir.\n\n### Modelo de primeira ordem\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-22_24741c81c66b6546cd05449a92e2881c'}\n\n```{.r .cell-code}\nlm2 <- lm(nplants~trat,\n          data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-23_3a1d2418f65111875ef18fdd29420725'}\n\n```{.r .cell-code}\nhist(residuals(lm2))\n```\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n### Modelo de segunda ordem\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-24_cde41e658b3c3b5354482c8247eb12b2'}\n\n```{.r .cell-code}\nexp2$trat2 <- exp2$trat^2\n\nlm3 <-lm(nplants ~trat + trat2,\n         data = exp2)\n\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-25_784bb60ad32fae82a4c86b9a0ad04d7c'}\n\n```{.r .cell-code}\nhist(residuals(lm3))\n```\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n### Comparando os modelos\n\nRealizando a comparação pelo AIC, temos\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-26_2d1aa76600f529daec17d8b96b8be251'}\n\n```{.r .cell-code}\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-27_314d2672257310294ee4bbcc0fec735d'}\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 193.1284\n```\n:::\n:::\n\n\nCom isso, observamos que o modelo linear se segunda ordem foi o melhor.\n\n### Outro Método de Comparação de Modelos Lineares\n\nO pacote **AgroR** tem funções que nos permitem comparar diferentes modelos. A conclusão é baseada no valor de R², que, quanto maior, mais preciso é o modelo (diferente do AIC).\n\nVeja como usá-lo para o mesmo conjunto de dados:\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-28_d3bb36dedcea27c0e48760c200904002'}\n\n```{.r .cell-code}\nlibrary(AgroR)\nwith(exp2, polynomial(trat, nplants, grau = 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n              Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 60.9857143  3.6304377 16.798447 4.929311e-14\ntrat        -0.7006912  0.1605226 -4.365063 2.473272e-04\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df      SSq       MSQ        F      p-value\nLinear     1 3196.203 3196.2031 21.82329 0.0001899378\nDeviation  4 1054.172  263.5430  1.79944 0.1729687460\nResidual  18 2636.250  146.4583                      \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-29_0ee843940969265dcdcbbd1f08447a34'}\n\n```{.r .cell-code}\nwith(exp2, polynomial(trat, nplants, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-30_0634835de0cb0c493adb476d35eb3f95'}\n\n```{.r .cell-code}\nwith(exp2, polynomial(trat, nplants, grau = 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n                Estimate  Std. Error   t value     Pr(>|t|)\n(Intercept) 70.265143802 5.300440019 13.256474 2.295186e-11\ntrat        -3.609380523 1.514625525 -2.383018 2.720299e-02\nI(trat^2)    0.140522077 0.091192577  1.540938 1.390058e-01\nI(trat^3)   -0.001712445 0.001309648 -1.307561 2.058546e-01\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ          F      p-value\nLinear     1 3196.2031 3196.2031 21.8232929 0.0001899378\nQuadratic  1  544.5029  544.5029  3.7178008 0.0697619482\nCubic      1  247.7520  247.7520  1.6916208 0.2097934169\nDeviation  2  261.9170  130.9585  0.8941691 0.4263523326\nResidual  18 2636.2500  146.4583                        \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\nObserva-se que o R² melhora conforme o aumento do grau. No entanto, não podemos aceitar o grau 3, pois o estande não aumenta a concentração de inóculo. O grau 2 é o mais adequado neste caso.\n\n## Modelo não linear\n\nModelos não lineares são utilizados quando a relação entre a variável dependente e as variáveis independentes não pode ser adequadamente descrita por uma função linear.\n\nPodemos utilizar modelos não lineares na análise estatística dos dados provenientes de um experimento que avaliou seis doses de um fungicida na inibição da germinação de conídios de vinte diferentes isolados. \n\nImportando, modificando e vizualizando os dados\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-31_271fce0227349166e062528e033014c9'}\n\n```{.r .cell-code}\nsensi <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n\nsensi2 <- sensi|> \n  group_by(code, dose) |> \n  summarise(mean_germination = mean(germination))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'code'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nsensi2 |>  \n  ggplot(aes(dose, mean_germination))+\n  geom_point()+\n  facet_wrap(~code)+\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              formula = y ~poly(x,2),\n              color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\nFiltrando um isolado para ajustar um modelo não linear através do pacote **drc**.\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-32_5cf38c87b60851ce8f30fc60c451d6b6'}\n\n```{.r .cell-code}\nisolado152 <- sensi2 |> \n  filter(code == \"152\")\n\nlibrary(drc)\n\ndrc1 <-  drm(mean_germination ~ dose, data = isolado152, \n             fct = LL.3())\n\nAIC(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 32.57898\n```\n:::\n:::\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-33_95ca0553b5c78e3a8a6c061410b134f2'}\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\nSumarizando o resultado\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-34_9ba12c1b99406657f193b97da9426452'}\n\n```{.r .cell-code}\nsummary(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  5.526512   7.765348  0.7117 0.5280076    \nd:(Intercept) 45.250173   1.876343 24.1162 0.0001563 ***\ne:(Intercept)  0.444356   0.077789  5.7123 0.0106434 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 2.65351 (3 degrees of freedom)\n```\n:::\n:::\n\n\nPara demonstrar qual dose inibe 50% da germinação de conídios do isolado que estamos avaliando separadamente, usamos:\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-35_0b7446b189c73b3e45a3d46cbe81fc2d'}\n\n```{.r .cell-code}\nED(drc1, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.444356   0.077789 0.196796 0.691916\n```\n:::\n:::\n\n\nEm experimentos semelhantes o pacote **ec50estimator** consegue realizar os ajuste dos modelos para todos os isolados de maneira mais simples. Observe:\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-36_9dba49b19374a8f318f72dadc34f1d96'}\n\n```{.r .cell-code}\nlibrary(ec50estimator)\ndf_ec50 <- estimate_EC50(mean_germination ~ dose,\n                         data = sensi2,\n                         isolate_col = \"code\",\n                         interval = \"delta\",\n                         fct = drc :: LL.3())\ndf_ec50\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      ID strata   Estimate  Std..Error        Lower     Upper\n1    152        0.44435629 0.077789240  0.196796213 0.6919164\n2    153        0.20379664 0.042373512  0.068945217 0.3386481\n3    164        0.50775844 0.047248266  0.357393370 0.6581235\n4    165        0.55839613 0.114195113  0.194976315 0.9218159\n5    169        0.14722311 0.009555688  0.116812646 0.1776336\n6    170        0.37503889 0.043207328  0.237533889 0.5125439\n7    186        0.57975744 0.013332268  0.537328208 0.6221867\n8    187        0.21563338 0.036639446  0.099030315 0.3322365\n9    188        0.15297172 0.004284691  0.139335920 0.1666075\n10   189        0.53106193 0.023130936  0.457448972 0.6046749\n11 FGT05        0.04483862 0.019290890 -0.016553601 0.1062308\n12 FGT06        0.54497946 0.034834602  0.434120211 0.6558387\n13 FGT07        0.88770053 0.079917704  0.633366725 1.1420343\n14 FGT28        0.22608141 0.033600742  0.119148854 0.3330140\n15 FGT29        0.23601652 0.034933881  0.124841318 0.3471917\n16 FGT33        0.10481627 0.013065221  0.063236910 0.1463956\n17 FGT34        0.14773114 0.047003373 -0.001854568 0.2973169\n18 FGT35        0.20315392 0.038984604  0.079087515 0.3272203\n19 FGT42        0.45000559 0.059685890  0.260058448 0.6399527\n20 FGT43        0.49589549 0.060850771  0.302241178 0.6895498\n```\n:::\n:::\n\n\nMontando um gráfico com as doses estimadas\n\n::: {.cell hash='Aula_8.1_cache/html/unnamed-chunk-37_e3e08fca62413545587d80afb39d6d9a'}\n\n```{.r .cell-code}\ndf_ec50 |> \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower, ymax = Upper))+\n  coord_flip()+\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula_8.1_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\nAssim fica mais fácil concluir sobre qual isolado é sensivel e qual é mais resistente!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}