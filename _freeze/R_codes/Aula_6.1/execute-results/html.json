{
  "hash": "aaa5a9e9849eb867337d9178d85a4cfc",
  "result": {
    "markdown": "---\ntitle: \" \"\nformat: html\n---\n\n\n# Análise de Variância (ANOVA)\n\n# ANOVA (DIC)\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-1_a67c13f665ece6c7a67a2e679db3f748'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggthemes)\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n\n#Vizualizar\nmicelial |> \n  ggplot(aes(especie, tcm))+\n  geom_boxplot(fill = \"gray\")+\n  geom_jitter(width = 0.1, size = 2)+\n  theme_few()\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nanova_micelial <- aov(tcm ~ especie, data = micelial)\n \nanova_micelial\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\n   aov(formula = tcm ~ especie, data = micelial)\n\nTerms:\n                  especie Residuals\nSum of Squares  1.4695800 0.4679167\nDeg. of Freedom         4        25\n\nResidual standard error: 0.1368089\nEstimated effects may be unbalanced\n```\n:::\n\n```{.r .cell-code}\nsummary(anova_micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \nespecie      4 1.4696  0.3674   19.63 2.03e-07 ***\nResiduals   25 0.4679  0.0187                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nanova(anova_micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nanova_micelial2 <- lm(tcm ~ especie, data = micelial)\n\nanova_micelial2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nCoefficients:\n(Intercept)  especieFaus  especieFcor  especieFgra  especieFmer  \n      1.572       -0.335       -0.250       -0.660       -0.145  \n```\n:::\n\n```{.r .cell-code}\nsummary(anova_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.57167    0.05585  28.140  < 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,\tAdjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n```\n:::\n\n```{.r .cell-code}\nanova(anova_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## ANOVA (DIC) Variância significativa\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-2_94335e3410feb91d0dbd4585317e87ce'}\n\n```{.r .cell-code}\nmicelial2 <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n\n#Vizualizar\nmicelial2 |> \n  ggplot(aes(especie, tcm))+\n  #geom_boxplot()+\n  geom_jitter(widh = 0.05, size = 2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_jitter(widh = 0.05, size = 2): Ignoring unknown parameters:\n`widh`\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\naov_micelial2 <- aov(tcm ~ especie, data = micelial2)\n \naov_micelial2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\n   aov(formula = tcm ~ especie, data = micelial2)\n\nTerms:\n                  especie Residuals\nSum of Squares  1.4695800 0.4679167\nDeg. of Freedom         4        25\n\nResidual standard error: 0.1368089\nEstimated effects may be unbalanced\n```\n:::\n\n```{.r .cell-code}\nsummary(aov_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \nespecie      4 1.4696  0.3674   19.63 2.03e-07 ***\nResiduals   25 0.4679  0.0187                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nanova(aov_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlm_micelial2 <- lm(tcm ~ especie, data = micelial2)\n\nlm_micelial2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial2)\n\nCoefficients:\n(Intercept)  especieFaus  especieFcor  especieFgra  especieFmer  \n      1.572       -0.335       -0.250       -0.660       -0.145  \n```\n:::\n\n```{.r .cell-code}\nsummary(lm_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.57167    0.05585  28.140  < 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,\tAdjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n```\n:::\n\n```{.r .cell-code}\nanova(lm_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Testes de comparações múltiplas\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-3_4ca9e53f834721515b2bb231954c5c6f'}\n\n```{.r .cell-code}\n#Demonstrando os agrupamentos de médias\ninstall.packages(\"emmeans\", repos = \"https://cran.r-project.org\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/david/AppData/Local/R/win-library/4.3'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\npackage 'emmeans' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n\tC:\\Users\\david\\AppData\\Local\\Temp\\RtmpaI6fsL\\downloaded_packages\n```\n:::\n\n```{.r .cell-code}\ninstall.packages(\"multcomp\", repos = \"https://cran.r-project.org\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/david/AppData/Local/R/win-library/4.3'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\npackage 'multcomp' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n\tC:\\Users\\david\\AppData\\Local\\Temp\\RtmpaI6fsL\\downloaded_packages\n```\n:::\n\n```{.r .cell-code}\ninstall.packages(\"multicompView\", repos = \"https://cran.r-project.org\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/david/AppData/Local/R/win-library/4.3'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'multicompView' is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n```\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: mvtnorm\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: survival\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: TH.data\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: MASS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'MASS'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'TH.data'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:MASS':\n\n    geyser\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcompView)\n\n\nmedias_lm <- emmeans(lm_micelial2, ~ especie)\n\nmedias_lm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(medias_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\n#Pressuposições para o novo conjunto de dados\n\nhist(lm_micelial2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(lm_micelial2$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  lm_micelial2$residuals\nW = 0.9821, p-value = 0.8782\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(tcm ~ especie, data = micelial2) # H0 é que a variâncias são homogêneas\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n:::\n\n```{.r .cell-code}\n#Usando o pacote 'DHARMa'\ninstall.packages(\"DHARMA\", repos = \"https://cran.r-project.org\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/david/AppData/Local/R/win-library/4.3'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'DHARMA' is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Perhaps you meant 'DHARMa' ?\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n:::\n\n```{.r .cell-code}\npresupposes <- plot(simulateResiduals(lm_micelial2))\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n## O pacote 'performance' também roda as presuposições\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-4_6f0238f816c3b23e7c40d43a42ab6deb'}\n\n```{.r .cell-code}\nlibrary(performance)\n\ncheck_normality(lm_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(lm_micelial2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n:::\n\n```{.r .cell-code}\nplot_presup <- check_model(lm_micelial2)\n\nplot_presup\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n##  Tranformação de dados e alternativas não-paramétricas da ANOVA \n\nE se as premissas não forem atendidas?\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-5_df6095383cc5e478011f9d2c47de3d8a'}\n\n```{.r .cell-code}\nInseticida <- InsectSprays\n\nInseticida |>\n  count(spray)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  spray  n\n1     A 12\n2     B 12\n3     C 12\n4     D 12\n5     E 12\n6     F 12\n```\n:::\n\n```{.r .cell-code}\nInseticida |> \n  ggplot(aes(spray, count))+\n  geom_boxplot(fill = \"gray\")+\n  geom_jitter(width = 0.1, size = 2)+\n  theme_classic()+\n  scale_fill_colorblind()\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-6_e5bfebeb4935c06c171533212c6ab717'}\n\n```{.r .cell-code}\nm1 <- lm (count ~ spray, data = Inseticida)\n\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 2668.8  533.77  34.702 < 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ spray, data = Inseticida)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.333 -1.958 -0.500  1.667  9.333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  14.5000     1.1322  12.807  < 2e-16 ***\nsprayB        0.8333     1.6011   0.520    0.604    \nsprayC      -12.4167     1.6011  -7.755 7.27e-11 ***\nsprayD       -9.5833     1.6011  -5.985 9.82e-08 ***\nsprayE      -11.0000     1.6011  -6.870 2.75e-09 ***\nsprayF        2.1667     1.6011   1.353    0.181    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.922 on 66 degrees of freedom\nMultiple R-squared:  0.7244,\tAdjusted R-squared:  0.7036 \nF-statistic:  34.7 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.96006, p-value = 0.02226\n```\n:::\n\n```{.r .cell-code}\nqqnorm(m1$residuals)\nqqline(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~ spray,\n              data = Inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.022).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n:::\n\n\n## Tranformando os dados\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-7_bc714c27755f7310f1986ed0b958bc28'}\n\n```{.r .cell-code}\nInseticida <- Inseticida |> \n  mutate(count2 = sqrt(count))\n\nInseticida |> \n  ggplot(aes(spray, count2, fill= spray))+\n  geom_boxplot()+\n  geom_jitter(width = 0.05, size = 2)+\n  theme_few()+\n  scale_fill_few()+\n  theme(legend.title = element_blank(), legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nm2 <- lm (count2 ~ spray, data = Inseticida)\n\nanova(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: count2\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 88.438 17.6876  44.799 < 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count2 ~ spray, data = Inseticida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.24486 -0.39970 -0.01902  0.42661  1.40089 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   3.7607     0.1814  20.733  < 2e-16 ***\nsprayB        0.1160     0.2565   0.452    0.653    \nsprayC       -2.5158     0.2565  -9.807 1.64e-14 ***\nsprayD       -1.5963     0.2565  -6.223 3.80e-08 ***\nsprayE       -1.9512     0.2565  -7.606 1.34e-10 ***\nsprayF        0.2579     0.2565   1.006    0.318    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6283 on 66 degrees of freedom\nMultiple R-squared:  0.7724,\tAdjusted R-squared:  0.7552 \nF-statistic:  44.8 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nhist(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m2$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m2$residuals\nW = 0.98721, p-value = 0.6814\n```\n:::\n\n```{.r .cell-code}\nqqnorm(m2$residuals)\nqqline(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\nbartlett.test(count2 ~ spray,\n              data = Inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count2 by spray\nBartlett's K-squared = 3.7525, df = 5, p-value = 0.5856\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.681).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.854).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m2))\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n:::\n\n\n## Agrupamento\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-8_045d045e3ca2a32465c961267c8c9668'}\n\n```{.r .cell-code}\nmedias1 <- emmeans(m1, ~ spray)\ncld(medias1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray emmean   SE df lower.CL upper.CL .group\n C       2.08 1.13 66   -0.177     4.34  1    \n E       3.50 1.13 66    1.240     5.76  1    \n D       4.92 1.13 66    2.656     7.18  1    \n A      14.50 1.13 66   12.240    16.76   2   \n B      15.33 1.13 66   13.073    17.59   2   \n F      16.67 1.13 66   14.406    18.93   2   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\ncld1 <- cld(emmeans(m1, ~ spray),alpha = 0.01, letters = LETTERS)\n\ncld1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray emmean   SE df lower.CL upper.CL .group\n C       2.08 1.13 66   -0.177     4.34  1    \n E       3.50 1.13 66    1.240     5.76  1    \n D       4.92 1.13 66    2.656     7.18  1    \n A      14.50 1.13 66   12.240    16.76   2   \n B      15.33 1.13 66   13.073    17.59   2   \n F      16.67 1.13 66   14.406    18.93   2   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.01 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\nmedias2 <- emmeans(m2, ~ spray)\ncld(medias2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray emmean    SE df lower.CL upper.CL .group\n C       1.24 0.181 66    0.883     1.61  a    \n E       1.81 0.181 66    1.447     2.17  ab   \n D       2.16 0.181 66    1.802     2.53   b   \n A       3.76 0.181 66    3.399     4.12    c  \n B       3.88 0.181 66    3.514     4.24    c  \n F       4.02 0.181 66    3.656     4.38    c  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n## Alternativa 2 - não paramétrico\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-9_8d75085769c432efee616c5513dfef37'}\n\n```{.r .cell-code}\nlibrary(agricolae)\nkruskal.test(count ~ spray, data = Inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n:::\n\n```{.r .cell-code}\nm3 <- kruskal(Inseticida$count,\n        Inseticida$spray,\n        group = TRUE)\nm3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$statistics\n     Chisq Df      p.chisq  t.value      MSD\n  54.69134  5 1.510845e-10 1.996564 8.462804\n\n$parameters\n            test p.ajusted           name.t ntr alpha\n  Kruskal-Wallis      none Inseticida$spray   6  0.05\n\n$means\n  Inseticida.count     rank      std  r Min Max   Q25  Q50   Q75\nA        14.500000 52.16667 4.719399 12   7  23 11.50 14.0 17.75\nB        15.333333 54.83333 4.271115 12   7  21 12.50 16.5 17.50\nC         2.083333 11.45833 1.975225 12   0   7  1.00  1.5  3.00\nD         4.916667 25.58333 2.503028 12   2  12  3.75  5.0  5.00\nE         3.500000 19.33333 1.732051 12   1   6  2.75  3.0  5.00\nF        16.666667 55.62500 6.213378 12   9  26 12.50 15.0 22.50\n\n$comparison\nNULL\n\n$groups\n  Inseticida$count groups\nF         55.62500      a\nB         54.83333      a\nA         52.16667      a\nD         25.58333      b\nE         19.33333     bc\nC         11.45833      c\n\nattr(,\"class\")\n[1] \"group\"\n```\n:::\n:::\n\n\n## Alternativa 3 - GLMs\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-10_f1ea4710f0f08d1de6121919f1c90b63'}\n\n```{.r .cell-code}\nm4 <- glm(count ~ spray,\n          family = poisson,\n          data = Inseticida)\n\n?glm\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nstarting httpd help server ... done\n```\n:::\n\n```{.r .cell-code}\nm4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = count ~ spray, family = poisson, data = Inseticida)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n    2.67415      0.05588     -1.94018     -1.08152     -1.42139      0.13926  \n\nDegrees of Freedom: 71 Total (i.e. Null);  66 Residual\nNull Deviance:\t    409 \nResidual Deviance: 98.33 \tAIC: 376.6\n```\n:::\n\n```{.r .cell-code}\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = count ~ spray, family = poisson, data = Inseticida)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  2.67415    0.07581  35.274  < 2e-16 ***\nsprayB       0.05588    0.10574   0.528    0.597    \nsprayC      -1.94018    0.21389  -9.071  < 2e-16 ***\nsprayD      -1.08152    0.15065  -7.179 7.03e-13 ***\nsprayE      -1.42139    0.17192  -8.268  < 2e-16 ***\nsprayF       0.13926    0.10367   1.343    0.179    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 409.041  on 71  degrees of freedom\nResidual deviance:  98.329  on 66  degrees of freedom\nAIC: 376.59\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n\n```{.r .cell-code}\nanova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev\nNULL                     71     409.04\nspray  5   310.71        66      98.33\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m4))\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmedias4 <- emmeans(m4, ~ spray, type = \"response\")\n\nmedias4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray  rate    SE  df asymp.LCL asymp.UCL\n A     14.50 1.099 Inf     12.50     16.82\n B     15.33 1.130 Inf     13.27     17.72\n C      2.08 0.417 Inf      1.41      3.08\n D      4.92 0.640 Inf      3.81      6.35\n E      3.50 0.540 Inf      2.59      4.74\n F     16.67 1.179 Inf     14.51     19.14\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n```\n:::\n\n```{.r .cell-code}\ncld(medias4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.099 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.179 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n## Transformação BoxCox\n\n\n::: {.cell hash='Aula_6.1_cache/html/unnamed-chunk-11_9c5a61f722eac7f26026441bacd079a5'}\n\n```{.r .cell-code}\nlibrary(MASS)\n\nb <- boxcox(lm(Inseticida$count+0.1 ~ 1))\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda <- b$x[which.max(b$y)]\nlambda = 0.5\n\nInseticida$count3 <-(Inseticida$count ^ lambda - 1) / lambda\n\nhist(Inseticida$count3)\n```\n\n::: {.cell-output-display}\n![](Aula_6.1_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\nInseticida$count3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  4.3245553  3.2915026  6.9442719  5.4833148  5.4833148  4.9282032\n [7]  4.3245553  7.5916630  6.2462113  6.9442719  5.4833148  5.2111026\n[13]  4.6332496  6.2462113  7.1651514  4.6332496  6.0000000  5.4833148\n[19]  6.2462113  6.2462113  6.7177979  7.1651514  3.2915026  5.2111026\n[25] -2.0000000  0.0000000  3.2915026  0.8284271  1.4641016  0.0000000\n[31]  0.8284271  0.0000000  1.4641016 -2.0000000  0.0000000  2.0000000\n[37]  1.4641016  2.4721360  4.9282032  2.8989795  2.0000000  1.4641016\n[43]  2.4721360  2.4721360  2.4721360  2.4721360  0.8284271  2.0000000\n[49]  1.4641016  2.4721360  1.4641016  2.4721360  1.4641016  2.8989795\n[55]  0.0000000  0.0000000  1.4641016  0.8284271  2.8989795  2.0000000\n[61]  4.6332496  4.0000000  5.7459667  7.3808315  5.7459667  6.0000000\n[67]  5.2111026  4.3245553  8.1980390  8.1980390  7.7979590  5.2111026\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}