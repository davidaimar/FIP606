{
  "hash": "8656d40f3a6e223f888183bec4935ac9",
  "result": {
    "markdown": "---\ntitle: \"ANOVA em DBC\"\nformat: html\n---\n\n\nExperimentos em DBC (Delineamento em Blocos Casualizados), são um tipo de design experimental utilizado para controlar variações provenientes de um ambiente exeperimental não homogêneo (não aleatórias) entre unidades experimentais.\n\nPodemos utilizar a função `aov()` ou `lm()` para realizar a ANOVA. A fórmula `resposta ~ tratamento + Error(bloco)` especifica que a variável resposta é explicada pelo efeito do tratamento, considerando o bloco como um fator de bloqueio (variável de erro).\n\nPacotes utilizados\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-1_7e671d60605f6df15cecdda7dd361169'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\nlibrary(ggthemes)\n```\n:::\n\n\nImportando os dados\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-2_ebf4ea5540c7be77daa801aeddc58f2e'}\n\n```{.r .cell-code}\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\nsoja <- soja |> \n  mutate(TRAT = as.factor(TRAT), BLOCO = as.factor(BLOCO))\n```\n:::\n\n\nVizualização gráfica paras as variáveis\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-3_cf4b86b4fac12fada79acc155f7e2d3d'}\n\n```{.r .cell-code}\nlibrary(patchwork)\n\ndfc <- soja |> \n  ggplot(aes(TRAT, DFC))+\n  geom_jitter(width = 0.1, color = 'gray')+\n  stat_summary(fun.data = \"mean_cl_boot\", color = 'black', alpha = 0.5)+\n  theme_few()\n\n\nfer <- soja |> \n  ggplot(aes(TRAT, FER))+\n  geom_jitter(width = 0.1, color = 'gray')+\n  stat_summary(fun.data = \"mean_cl_boot\", color = 'black', alpha = 0.5)+\n  theme_few()\n\nprod <- soja |> \n  ggplot(aes(TRAT, PROD))+\n  geom_jitter(width = 0.1, color = 'gray')+\n  stat_summary(fun.data = \"mean_cl_boot\", color = 'black', alpha = 0.5)+\n  theme_few()\n\ndfc + fer + prod\n```\n\n::: {.cell-output-display}\n![](Aula_7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nRealizando a ANOVA\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-4_5f984505a88779e173526d41e92a77af'}\n\n```{.r .cell-code}\naov_dfc <- lm (DFC ~ TRAT + BLOCO, data = soja)\n\nanova(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: DFC\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 149.299 21.3284 51.5490 8.218e-12 ***\nBLOCO      3   0.461  0.1537  0.3716    0.7743    \nResiduals 21   8.689  0.4138                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nVale lembrar que para prosseguir com a ANOVA em DBC as mesmas pressuposições para ANOVA em DIC devem ser atendidas. Os testes são feitos como foi demonstrado para ANOVA em DIC.\n\nObservando os grupos de médias\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-5_a7b9546191d9541824a625acfc219d5e'}\n\n```{.r .cell-code}\nlibrary(multcomp)\nlibrary(emmeans)\n\nmedias_dfc <- emmeans(aov_dfc, ~ TRAT)\n\nmedias_dfc\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean    SE df lower.CL upper.CL\n 1     10.88 0.322 21    10.21    11.54\n 2      6.42 0.322 21     5.76     7.09\n 3      6.05 0.322 21     5.38     6.72\n 4      4.75 0.322 21     4.08     5.42\n 5      4.20 0.322 21     3.53     4.87\n 6      4.00 0.322 21     3.33     4.67\n 7      4.08 0.322 21     3.41     4.74\n 8      4.58 0.322 21     3.91     5.24\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n:::\n:::\n\n\nTeste Tukey\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-6_32fd9f957f9b8bce38eee4ce46f61dfc'}\n\n```{.r .cell-code}\npwpm(medias_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1       2       3       4       5       6       7       8\n1 [10.87]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   4.450 [ 6.42]  0.9896  0.0249  0.0017  0.0006  0.0009  0.0107\n3   4.825   0.375 [ 6.05]  0.1329  0.0107  0.0040  0.0058  0.0628\n4   6.125   1.675   1.300 [ 4.75]  0.9202  0.7173  0.8072  0.9999\n5   6.675   2.225   1.850   0.550 [ 4.20]  0.9998  1.0000  0.9896\n6   6.875   2.425   2.050   0.750   0.200 [ 4.00]  1.0000  0.9020\n7   6.800   2.350   1.975   0.675   0.125  -0.075 [ 4.07]  0.9499\n8   6.300   1.850   1.475   0.175  -0.375  -0.575  -0.500 [ 4.57]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n:::\n\n\nAgrupamento\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-7_a0c6be166e9ac9ac03979e69d5e197aa'}\n\n```{.r .cell-code}\ncld(medias_dfc, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean    SE df lower.CL upper.CL .group\n 6      4.00 0.322 21     3.33     4.67  a    \n 7      4.08 0.322 21     3.41     4.74  a    \n 5      4.20 0.322 21     3.53     4.87  a    \n 8      4.58 0.322 21     3.91     5.24  ab   \n 4      4.75 0.322 21     4.08     5.42  ab   \n 3      6.05 0.322 21     5.38     6.72   bc  \n 2      6.42 0.322 21     5.76     7.09    c  \n 1     10.88 0.322 21    10.21    11.54     d \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nQuando se tem mais de uma variável resposta no conjunto de dados a anova deve ser feita para cada uma.\n\n## Adicionando as letras do Teste Tukey em Gráficos\n\nOs resultados da análise de variância junto com o teste tukey podem ser ilustrados em gráficos.\n\nVeja a demonstração para a variável produtividade\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-8_84d9cbb1f0bba5c638626d969d313bcd'}\n\n```{.r .cell-code}\naov_prod <- lm (PROD ~ TRAT + BLOCO, data = soja)\n\nanova(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: PROD\n          Df  Sum Sq Mean Sq F value  Pr(>F)  \nTRAT       7 2993906  427701  2.6367 0.04021 *\nBLOCO      3  105665   35222  0.2171 0.88340  \nResiduals 21 3406431  162211                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-9_b403432941cbdfe7010886e3b471e441'}\n\n```{.r .cell-code}\nmedias_prod <- emmeans(aov_prod, ~ TRAT)\n\ncld(medias_prod, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 201 21     3800     4638  a    \n 2      4935 201 21     4516     5354  ab   \n 8      5078 201 21     4659     5497  ab   \n 3      5110 201 21     4691     5529  ab   \n 5      5122 201 21     4703     5541  ab   \n 7      5128 201 21     4709     5546  ab   \n 4      5140 201 21     4721     5559  ab   \n 6      5256 201 21     4837     5675   b   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nProduzindo o gráfico e adicionando as letras correspondentes aos grupos de médias:\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-10_f9527eb13efb29de01bdce184ed7dbbb'}\n\n```{.r .cell-code}\ndf_prod <- data.frame(medias_prod)\ndf_prod|>\n  ggplot(aes(TRAT,emmean))+\n  geom_point()+\n  ylim(2000, 6500)+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL,\n                    width = 0.1))+\n  theme_few()+\n  annotate(geom = \"text\", x = 1.2, y = 4250,\n           label = \"a\")+\n    annotate(geom = \"text\", x = 2.3, y = 4900,\n           label = \"ab\")+\n    annotate(geom = \"text\", x = 3.3, y = 5150,\n           label = \"ab\")+\n  annotate(geom = \"text\", x = 4.3, y = 5155,\n           label = \"ab\")+\n    annotate(geom = \"text\", x = 5.3, y = 5200,\n           label = \"ab\")+\n    annotate(geom = \"text\", x = 6.3, y = 5275,\n           label = \"ab\")+\n    annotate(geom = \"text\", x = 7.3, y = 5150,\n           label = \"ab\")+\n    annotate(geom = \"text\", x = 8.2, y = 5140,\n           label = \"b\")\n```\n\n::: {.cell-output-display}\n![](Aula_7_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nVeja também como sumarizar os resultados em uma tabela\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-11_78376c9146f23123989d63a19a2cc9d9'}\n\n```{.r .cell-code}\ndf_prod <- cld(medias_prod, Letters = LETTERS)\ndf_prod <- as.data.frame(df_prod)\n\nknitr::kable(df_prod |> dplyr::select(TRAT, emmean, .group))\n```\n\n::: {.cell-output-display}\n|   |TRAT |  emmean|.group |\n|:--|:----|-------:|:------|\n|1  |1    | 4219.25|A      |\n|2  |2    | 4935.00|AB     |\n|8  |8    | 5078.25|AB     |\n|3  |3    | 5110.00|AB     |\n|5  |5    | 5122.00|AB     |\n|7  |7    | 5127.50|AB     |\n|4  |4    | 5140.25|AB     |\n|6  |6    | 5256.25|B      |\n:::\n\n```{.r .cell-code}\nlibrary(writexl)\n\nwrite_xlsx(df_prod, \"df.xlsx\")\n```\n:::\n\n\n## Área Abaixo da Curva de Progresso da Doença (AACPD)\n\nA AACPD é uma medida quantitativa utilizada em estudos agrícolas e de saúde para avaliar a evolução temporal de uma doença ou de outro fenômeno que varia ao longo do tempo. Essa métrica é especialmente útil em experimentos onde se deseja comparar diferentes tratamentos ou condições em relação à severidade ou incidência de uma doença ao longo de um período de tempo.\n\nVamos analisar um conjunto de dados que lida com valores de severidade ao longo do tempo\n\nImportação e vizualização dos dados\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-12_017ca0b147e52d65b4b8401df3277d71'}\n\n```{.r .cell-code}\ncurve <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1807247585\")\n\ncurve |> \n  ggplot(aes(day, severity))+\n  geom_point()+\n  facet_wrap(~Irrigation)\n```\n\n::: {.cell-output-display}\n![](Aula_7_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(mean_sev = mean(severity)) |>\n  ggplot(aes(day, mean_sev, color = Irrigation))+\n  geom_point( color = \"black\")+\n  geom_line()+\n  theme_few()+\n  labs(x = \"Days\", y = \"Severity (%)\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'day'. You can override using the `.groups`\nargument.\n```\n:::\n\n::: {.cell-output-display}\n![](Aula_7_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n\n\nObtenção da AACPD, através da função `AUDPC()` do pacote **epifitter**.\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-13_2ebce1194a37294ce1b786aabf1746fe'}\n\n```{.r .cell-code}\nlibrary(epifitter)\ncurve2 <- curve |> \n  group_by(Irrigation, rep) |> \n  summarise(aacpd = AUDPC(day, severity))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Irrigation'. You can override using the\n`.groups` argument.\n```\n:::\n:::\n\n\nRealizando a ANOVA para AACPD\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-14_b22f01021e2bc7614c8d9828d69fdece'}\n\n```{.r .cell-code}\nm_curve <- lm(aacpd ~ Irrigation + factor(rep),\n              data = curve2)\n\nanova(m_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: aacpd\n            Df  Sum Sq  Mean Sq F value  Pr(>F)  \nIrrigation   1 0.23602 0.236017  10.605 0.08275 .\nfactor(rep)  2 0.61291 0.306454  13.771 0.06770 .\nResiduals    2 0.04451 0.022254                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nChecando as premissas\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-15_8798f9501c54fc08c400175604681299'}\n\n```{.r .cell-code}\nlibrary(performance)\n\ncheck_normality(m_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.380).\n```\n:::\n:::\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-16_13f57ec4fbd5bfe9820337f4f3fd1f26'}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.704).\n```\n:::\n:::\n\n\nTeste Tukey\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-17_05dc0b1662d9f4fe20a3ad2590e40d1b'}\n\n```{.r .cell-code}\nlibrary(emmeans)\nlibrary(multcomp)\n\nmed_curve <- emmeans(m_curve, ~ Irrigation)\n\ncld(med_curve, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Irrigation emmean     SE df lower.CL upper.CL .group\n Drip         13.4 0.0861  2     13.0     13.8  a    \n Furrow       13.8 0.0861  2     13.4     14.2  a    \n\nResults are averaged over the levels of: rep \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n## Coenficiente de Variação (CV)\n\nO CV é uma medida estatística que expressa a variabilidade relativa de uma amostra ou de um conjunto de dados em relação à sua média. Na ANOVA, o CV pode ser útil para comparar a dispersão dos dados entre diferentes tratamentos.\n\nO CV é calculado pelo desvio padrão amostral divido pela média amostral e mulriplicado por 100.\n\nÉ possivel obter o CV através da função `cv.model()` do pacote **agricolae**.\n\n\n::: {.cell hash='Aula_7_cache/html/unnamed-chunk-18_363616707434b6cdcd616fe9ff25d91d'}\n\n```{.r .cell-code}\nlibrary(agricolae)\n\ncv.model(m_curve) # 'm_curve' é o objeto com a saída da última ANOVA realizada\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.097572\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}